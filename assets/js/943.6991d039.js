"use strict";(self["webpackChunkchatgpt"]=self["webpackChunkchatgpt"]||[]).push([[943],{7220:function(e,a,t){function l(e){const a=6e4,t=60*a,l=24*t,i=7*l,n=30*l,o=(new Date).getTime(),s=o-e;if(s<0)return;let c;return c=s<=a?"刚刚":s<=t?Math.floor(s/a)+"分钟前":s<=l?Math.floor(s/t)+"小时前":s<=i?Math.floor(s/l)+"天前":s<=n?Math.floor(s/i)+"周前":s<=12*n?Math.floor(s/n)+"月前":Math.floor(s/(12*n))+"年前",c}t.d(a,{Z:function(){return l}})},789:function(e,a,t){t.d(a,{Z:function(){return f}});var l=t(3396),i=t(7139);const n={style:{width:"100%"}},o={class:"InputFormFieldWapper"},s={key:1,class:"animation-dot"},c=(0,l.uE)('<div class="dot0" data-v-2aa54a74></div><div class="dot1" data-v-2aa54a74></div><div class="dot2" data-v-2aa54a74></div><div class="dot3" data-v-2aa54a74></div><div class="dot4" data-v-2aa54a74></div>',5),u=[c];function d(e,a,t,c,d,r){const v=(0,l.up)("el-option"),p=(0,l.up)("el-select"),g=(0,l.up)("el-input"),m=(0,l.up)("Promotion"),f=(0,l.up)("el-icon");return(0,l.wg)(),(0,l.iD)("div",n,[(0,l._)("div",o,[e.needSelect?((0,l.wg)(),(0,l.j4)(p,{key:0,modelValue:e.modelInner,"onUpdate:modelValue":a[0]||(a[0]=a=>e.modelInner=a),class:"selectWrapper",placeholder:"Ai模型",onChange:e.updateModel},{default:(0,l.w5)((()=>[(0,l.Wm)(v,{value:"BASIC",label:"智能"}),(0,l.Wm)(v,{value:"ADVANCED",label:"增强"})])),_:1},8,["modelValue","onChange"])):(0,l.kq)("",!0),(0,l.Wm)(g,{style:(0,i.j5)({marginLeft:e.needSelect?"0px":"10px"}),onKeydown:e.handleKeyDown,modelValue:e.inputTextInner,"onUpdate:modelValue":a[1]||(a[1]=a=>e.inputTextInner=a),autosize:"",onInput:e.updateInputText,ref:"inputRefInner",type:"textarea",placeholder:e.aiLoading?"思考中..":"输入你想问的...  ctrl+enter发送",disabled:e.aiLoading},null,8,["style","onKeydown","modelValue","onInput","placeholder","disabled"]),e.aiLoading?((0,l.wg)(),(0,l.iD)("div",s,u)):((0,l.wg)(),(0,l.iD)("div",{key:2,onClick:a[2]||(a[2]=(...a)=>e.onSubmit&&e.onSubmit(...a)),class:"sendIcon"},[(0,l.Wm)(f,{size:20},{default:(0,l.w5)((()=>[(0,l.Wm)(m)])),_:1})]))])])}var r=t(2748),v=t(4870),p=(0,l.aZ)({name:"InputFormField",components:{Promotion:r.Promotion},props:{needSelect:{type:Boolean,default:!0},model:{type:String,default:null},inputText:{type:String,default:null},aiLoading:{type:Boolean,default:!1}},setup(e,{emit:a}){let t=(0,v.iH)(null),i=(0,v.iH)("BASIC");const n=(0,v.iH)(null);function o(){n.value&&n.value.clear()}function s(e){e.ctrlKey&&13===e.keyCode&&a("onSubmit")}function c(){a("onSubmit")}function u(e){i=e,a("update:model",e)}function d(e){t.value=e}return(0,l.YP)((()=>e.model),(e=>{i=e})),(0,l.YP)(t,((e,t)=>{a("update:inputText",e)})),{updateInputText:d,onSubmit:c,handleKeyDown:s,updateModel:u,resetInputValue:o,inputTextInner:t,modelInner:i,inputRefInner:n}}}),g=t(89);const m=(0,g.Z)(p,[["render",d],["__scopeId","data-v-2aa54a74"]]);var f=m},1943:function(e,a,t){t.r(a),t.d(a,{default:function(){return ue}});var l=t(3396),i=t(7139),n=t(9242),o=t(2677);const s=e=>((0,l.dD)("data-v-72c083c0"),e=e(),(0,l.Cn)(),e),c={class:"body",ref:"scrollRef"},u={key:0,class:"explain"},d=s((()=>(0,l._)("img",{class:"logo",alt:"Vue logo",src:o},null,-1))),r=s((()=>(0,l._)("div",{class:"expositoryCase"},"欢迎使用 NEW BING PLUS",-1))),v={class:"consume"},p=s((()=>(0,l._)("div",{class:"consumeText"},"超级实验室功能",-1))),g=s((()=>(0,l._)("div",{class:"beCareful"},"请注意不支持违法、违规等不当信息内容",-1))),m={key:1,class:"questions",style:{margin:"20px 0"}},f={class:"question"},h={class:"text"},y={class:"operation--model_user"},w=["onClick"],C=s((()=>(0,l._)("text",{class:"op-font"},"复制",-1))),x={class:"answer"},_={key:0},b={key:0,class:"operation--model"},S=["onClick"],k=s((()=>(0,l._)("text",{class:"op-font"},"复制",-1))),W=["onClick"],D=s((()=>(0,l._)("text",{class:"op-font"},"收藏",-1))),I={key:1,class:"answer-data",style:{width:"100px"}},L=(0,l.uE)('<div style="display:flex;padding:5px 9px;" data-v-72c083c0><div class="dot_0" data-v-72c083c0></div><div class="dot_1" data-v-72c083c0></div><div class="dot_2" data-v-72c083c0></div><div class="dot_3" data-v-72c083c0></div><div class="dot_4" data-v-72c083c0></div></div>',1),H=[L],V=s((()=>(0,l._)("div",null,"暂停输出",-1))),F={class:"footer"},T={class:"footer-bar"},N={style:{"padding-top":"4px"}},M=s((()=>(0,l._)("div",null,"清除聊天",-1))),U={style:{"padding-top":"4px"}},z=s((()=>(0,l._)("div",null,"记忆回溯",-1))),R=s((()=>(0,l._)("div",{class:"cache-flex-center"},[(0,l._)("img",{alt:"Vue logo",src:o,class:"cache-img"})],-1))),E=s((()=>(0,l._)("div",{class:"cache-text"},"NEW BING PLUS",-1))),P={class:"cache-flex-center cache-padding-top"},A=s((()=>(0,l._)("div",{class:"cache-btn-text"},"创建新的聊天",-1))),K={class:"cache-content"},O={class:"cache-scrollbar"},Z={class:"cache-flex-space-between cache-margin"},q=["onClick"],J={class:"cache-message-text"},Y={class:"cache-message-time"},B={class:"cache-selected"},G=["src","onClick"];function j(e,a,o,s,L,j){const $=(0,l.up)("Goods"),Q=(0,l.up)("el-icon"),X=(0,l.up)("CopyDocument"),ee=(0,l.up)("el-avatar"),ae=(0,l.up)("v-md-editor"),te=(0,l.up)("StarFilled"),le=(0,l.up)("VideoPause"),ie=(0,l.up)("Clock"),ne=(0,l.up)("ChatDotRound"),oe=(0,l.up)("InputFormField"),se=(0,l.up)("ChatLineSquare"),ce=(0,l.up)("el-scrollbar"),ue=(0,l.up)("el-dialog"),de=(0,l.up)("LoginDialog");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",c,[s.conversationList.length?((0,l.wg)(),(0,l.iD)("div",m,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.conversationList,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{key:a,class:"item slide-animation"},[(0,l._)("div",f,[(0,l._)("div",null,[(0,l._)("div",h,(0,i.zw)(e.user),1),(0,l._)("div",y,[(0,l._)("div",{class:"op-btn",onClick:a=>s.copyAnswer(e.user)},[(0,l.Wm)(Q,null,{default:(0,l.w5)((()=>[(0,l.Wm)(X)])),_:1}),C],8,w)])]),(0,l.Wm)(ee,{class:"flexShrink",size:35,icon:j.UserFilled,src:j.store.getters.userinfo.avatar?s.imageUrl+j.store.getters.userinfo.avatar:t(2231)},null,8,["icon","src"])]),(0,l._)("div",x,[(0,l.Wm)(ee,{class:"flexShrink",size:35,icon:j.UserFilled,src:t(2677)},null,8,["icon","src"]),e.assistant?((0,l.wg)(),(0,l.iD)("div",_,[(0,l._)("div",{class:"answer-data",style:(0,i.j5)({width:s.calculateWidth(e.assistant)})},[(0,l.Wm)(ae,{"model-value":e.assistant,mode:"preview",onCopyCodeSuccess:s.handleCopyCodeSuccess},null,8,["model-value","onCopyCodeSuccess"])],4),e.isError?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",b,[(0,l._)("div",{class:"op-btn",onClick:a=>s.copyAnswer(e.assistant)},[(0,l.Wm)(Q,null,{default:(0,l.w5)((()=>[(0,l.Wm)(X)])),_:1}),k],8,S),e.isCollection?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",{key:0,class:"op-btn",onClick:t=>s.onCollection(e,a)},[(0,l.Wm)(Q,{color:"rgb(255,236,160)"},{default:(0,l.w5)((()=>[(0,l.Wm)(te)])),_:1}),D],8,W))]))])):((0,l.wg)(),(0,l.iD)("div",I,H))])])))),128))])):((0,l.wg)(),(0,l.iD)("div",u,[d,r,(0,l._)("div",v,[(0,l.Wm)(Q,null,{default:(0,l.w5)((()=>[(0,l.Wm)($)])),_:1}),p]),g])),(0,l.wy)((0,l._)("div",{class:"suspend",onClick:a[0]||(a[0]=(...e)=>s.closeSocket&&s.closeSocket(...e))},[(0,l.Wm)(Q,{size:16},{default:(0,l.w5)((()=>[(0,l.Wm)(le)])),_:1}),V],512),[[n.F8,s.aiLoading]]),(0,l._)("div",F,[(0,l._)("div",T,[(0,l.wy)((0,l._)("div",{class:"clear",onClick:a[1]||(a[1]=(...e)=>s.clear&&s.clear(...e))},[(0,l._)("div",N,[(0,l.Wm)(Q,{size:"13px",style:{"padding-right":"3px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(ie)])),_:1})]),M],512),[[n.F8,j.store.getters.userinfo&&!s.aiLoading]]),(0,l.wy)((0,l._)("div",{class:"clear2",onClick:a[2]||(a[2]=e=>s.dialogueDisplay=!0)},[(0,l._)("div",U,[(0,l.Wm)(Q,{size:"13px",style:{"padding-right":"3px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(ne)])),_:1})]),z],512),[[n.F8,j.store.getters.userinfo&&!s.aiLoading]]),(0,l.Wm)(oe,{ref:"inputRef",needSelect:!1,aiLoading:s.aiLoading,inputText:s.input,"onUpdate:inputText":a[3]||(a[3]=e=>s.input=e),"onUpdate:model":a[4]||(a[4]=a=>e.model=a),onOnSubmit:s.onSubmit},null,8,["aiLoading","inputText","onOnSubmit"])])])],512),(0,l.Wm)(ue,{modelValue:s.dialogueDisplay,"onUpdate:modelValue":a[6]||(a[6]=e=>s.dialogueDisplay=e),title:"",width:"430px",center:"",style:{"background-color":"var(--bgColor1)"}},{default:(0,l.w5)((()=>[(0,l._)("div",null,[R,E,(0,l._)("div",P,[(0,l._)("div",{class:"cache-btn",onClick:a[5]||(a[5]=(...e)=>s.createdNewChat&&s.createdNewChat(...e))},[(0,l.Wm)(Q,{size:"16px"},{default:(0,l.w5)((()=>[(0,l.Wm)(se)])),_:1}),A])]),(0,l._)("div",K,[(0,l._)("div",O,[(0,l.Wm)(ce,{height:"250px"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.bingCache.array,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{class:"cache-padding",key:a},[(0,l._)("div",Z,[(0,l._)("div",{class:"cache-message",onClick:e=>s.switchChat(a)},[(0,l._)("div",J,(0,i.zw)(e.title),1),(0,l._)("div",Y,(0,i.zw)(j.conversionTime(e.time)),1)],8,q),(0,l._)("div",B,[(0,l._)("img",{src:s.bingCache.index===a?t(4172):t(5860),class:"cache-selected-img",onClick:e=>s.clearDialogue(a)},null,8,G)])])])))),128))])),_:1})])])])])),_:1},8,["modelValue"]),(0,l.Wm)(de,{show:s.loginVisible,onClose:a[7]||(a[7]=e=>s.loginVisible=!1)},null,8,["show"])],64)}t(541),t(7658);var $=t(4870),Q=t(2748),X=t(6666),ee=t(7278),ae=t(65),te=t(718),le=t(789),ie=t(4239),ne=t(7220),oe={name:"dialogueView",methods:{conversionTime:ne.Z},components:{InputFormField:le.Z,StarFilled:Q.StarFilled,CopyDocument:Q.CopyDocument,ChatDotRound:Q.ChatDotRound,ChatLineSquare:Q.ChatLineSquare,Clock:Q.Clock,VideoPause:Q.VideoPause,Goods:Q.Goods,LoginDialog:te.Z},computed:{store(){return ie.Z},UserFilled(){return Q.UserFilled}},setup(){let e=(0,$.iH)(50),a=(0,$.iH)(740),t=(0,$.iH)(null),i=(0,ae.oR)(),n=(0,$.iH)(null),o=(0,$.iH)(""),s=(0,$.iH)([]),c=(0,$.iH)(!1),u=(0,$.iH)(null),d=(0,$.iH)(!1);const r=(0,$.iH)("");let v=(0,$.iH)(!1);const p=(0,$.iH)({}),g=(0,$.iH)("30%"),m=(0,$.iH)(1e3);function f(e){e.ctrlKey&&13===e.keyCode&&(console.log("Alt + Enter 被按下"),b())}function h(){window.innerWidth<=768?g.value="70%":g.value="30%"}function y(e){p.value.index=e,s.value=p.value.array[e].context,localStorage.setItem("bingCache",JSON.stringify(p.value)),v.value=!1}function w(t){const l=t.length;let i=e.value+16*l;return i>=a.value&&(i=a.value),`${i}px`}function C(e){if(e!==p.value.index){let a=parseInt(p.value.index);e<a&&(p.value.index=a-1),p.value.array.splice(e,1)}localStorage.setItem("bingCache",JSON.stringify(p.value))}function x(){let e=s.value,a=p.value;p.value.array[a.index].time=Date.now(),e.length>0&&(p.value.array[a.index].title=e[e.length-1].user.trim().slice(0,25)),p.value.array[a.index].context=e,localStorage.setItem("bingCache",JSON.stringify(p.value))}function _(){p.value.array.unshift({title:"新对话",time:Date.now(),context:[]}),p.value.index=0,s.value=[],localStorage.setItem("bingCache",JSON.stringify(p.value))}async function b(){if(!i.getters.userinfo)return c.value=!0;if(""===o.value.trim())return;let e=s.value.length,a=o.value;t.value.resetInputValue(),s.value.push({user:a}),d.value=!0,W(),a=a.slice(0,m.value),S({messages:{messages:a},index:e})}function S({messages:e,index:a}){"undefined"==typeof WebSocket?console.log("您的浏览器不支持WebSocket"):(null!=u.value&&(u.value.close(),u.value=null),u.value=new WebSocket("ws://47.109.74.83:8625/bing/api/"+localStorage.getItem("token")),u.value.onopen=function(){u.value.send(JSON.stringify(e.messages)),s.value[a].isError=!0},u.value.onmessage=function(e){s.value[a].assistant=e.data,W()},u.value.onclose=function(){let e=s.value[a].assistant;s.value[a].isError=!1,e||s.value.splice(a,1),x(),k(),d.value=!1,W(),(0,l.Y3)((()=>{t.value.$refs.inputRefInner.focus()}))},u.value.onerror=function(){(0,X.bM)({title:"信息过期",message:"登录信息已过期,请重新登录",type:"error"}),localStorage.removeItem("token"),localStorage.removeItem("user"),location.reload()})}async function k(){let e=await(0,ee.CC)();i.commit("setUserinfo",e)}function W(){(0,l.Y3)((()=>{n.value.scrollTop=n.value.scrollHeight}))}function D(e){navigator.clipboard.writeText(e),(0,X.bM)({message:"复制成功",type:"success"})}function I(e){navigator.clipboard.writeText(e),(0,X.bM)({message:"复制成功",type:"success"})}function L(){u.value&&(u.value.close(),u.value=null)}function H(){L(),s.value=[],x()}async function V(e,a){try{let l=!s.value[a].isCollection;if(l)try{await(0,ee.wm)({issue:e.user,answer:e.assistant}),(0,X.bM)({message:"收藏成功",type:"success"})}catch(t){(0,X.bM)({message:t,type:"error"})}s.value[a].isCollection=!0}catch(t){(0,X.bM)({message:t,type:"error"})}}return(0,l.bv)((()=>{window.addEventListener("resize",h),h(),i.getters.userinfo&&k(),r.value="https://img-hh.oss-cn-hangzhou.aliyuncs.com",m.value=parseInt("2000");let e=localStorage.getItem("bingCache");if(i.getters.userinfo){if(!i.getters.userinfo)return c.value=!0;if(e){p.value=JSON.parse(e);let a=p.value;s.value=a.array[a.index].context,W()}else p.value={index:0,array:[{title:"新对话",time:Date.now(),context:s.value}]},localStorage.setItem("bingCache",JSON.stringify(p.value))}})),{handleKeyDown:f,inputRef:t,onSubmit:b,input:o,clear:H,conversationList:s,scrollRef:n,handleCopyCodeSuccess:D,loginVisible:c,onCollection:V,copyAnswer:I,aiLoading:d,closeSocket:L,imageUrl:r,dialogueDisplay:v,bingCache:p,createdNewChat:_,switchChat:y,clearDialogue:C,dialogueWidth:g,calculateWidth:w,initialWidth:e,maxWidth:a}}},se=t(89);const ce=(0,se.Z)(oe,[["render",j],["__scopeId","data-v-72c083c0"]]);var ue=ce},2677:function(e,a,t){e.exports=t.p+"assets/img/bing.0808f158.svg"},5860:function(e,a,t){e.exports=t.p+"assets/img/close.5a0f034d.svg"},4172:function(e,a,t){e.exports=t.p+"assets/img/selected04.f29dcd66.svg"},2231:function(e,a,t){e.exports=t.p+"assets/img/my.5065d1f5.png"}}]);