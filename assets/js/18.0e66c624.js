"use strict";(self["webpackChunkchatgpt"]=self["webpackChunkchatgpt"]||[]).push([[18],{7220:function(e,t,l){function a(e){const t=6e4,l=60*t,a=24*l,o=7*a,n=30*a,i=(new Date).getTime(),s=i-e;if(s<0)return;let u;return u=s<=t?"刚刚":s<=l?Math.floor(s/t)+"分钟前":s<=a?Math.floor(s/l)+"小时前":s<=o?Math.floor(s/a)+"天前":s<=n?Math.floor(s/o)+"周前":s<=12*n?Math.floor(s/n)+"月前":Math.floor(s/(12*n))+"年前",u}l.d(t,{Z:function(){return a}})},789:function(e,t,l){l.d(t,{Z:function(){return g}});var a=l(3396),o=l(7139);const n={style:{width:"100%"}},i={class:"InputFormFieldWapper"},s={key:1,class:"animation-dot"},u=(0,a.uE)('<div class="dot0" data-v-2aa54a74></div><div class="dot1" data-v-2aa54a74></div><div class="dot2" data-v-2aa54a74></div><div class="dot3" data-v-2aa54a74></div><div class="dot4" data-v-2aa54a74></div>',5),r=[u];function c(e,t,l,u,c,d){const p=(0,a.up)("el-option"),m=(0,a.up)("el-select"),v=(0,a.up)("el-input"),f=(0,a.up)("Promotion"),g=(0,a.up)("el-icon");return(0,a.wg)(),(0,a.iD)("div",n,[(0,a._)("div",i,[e.needSelect?((0,a.wg)(),(0,a.j4)(m,{key:0,modelValue:e.modelInner,"onUpdate:modelValue":t[0]||(t[0]=t=>e.modelInner=t),class:"selectWrapper",placeholder:"Ai模型",onChange:e.updateModel},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{value:"BASIC",label:"智能"}),(0,a.Wm)(p,{value:"ADVANCED",label:"增强"})])),_:1},8,["modelValue","onChange"])):(0,a.kq)("",!0),(0,a.Wm)(v,{style:(0,o.j5)({marginLeft:e.needSelect?"0px":"10px"}),onKeydown:e.handleKeyDown,modelValue:e.inputTextInner,"onUpdate:modelValue":t[1]||(t[1]=t=>e.inputTextInner=t),autosize:"",onInput:e.updateInputText,ref:"inputRefInner",type:"textarea",placeholder:e.aiLoading?"思考中..":"输入你想问的...  ctrl+enter发送",disabled:e.aiLoading},null,8,["style","onKeydown","modelValue","onInput","placeholder","disabled"]),e.aiLoading?((0,a.wg)(),(0,a.iD)("div",s,r)):((0,a.wg)(),(0,a.iD)("div",{key:2,onClick:t[2]||(t[2]=(...t)=>e.onSubmit&&e.onSubmit(...t)),class:"sendIcon"},[(0,a.Wm)(g,{size:20},{default:(0,a.w5)((()=>[(0,a.Wm)(f)])),_:1})]))])])}var d=l(2748),p=l(4870),m=(0,a.aZ)({name:"InputFormField",components:{Promotion:d.Promotion},props:{needSelect:{type:Boolean,default:!0},model:{type:String,default:null},inputText:{type:String,default:null},aiLoading:{type:Boolean,default:!1}},setup(e,{emit:t}){let l=(0,p.iH)(null),o=(0,p.iH)("BASIC");const n=(0,p.iH)(null);function i(){n.value&&n.value.clear()}function s(e){e.ctrlKey&&13===e.keyCode&&t("onSubmit")}function u(){t("onSubmit")}function r(e){o=e,t("update:model",e)}function c(e){l.value=e}return(0,a.YP)((()=>e.model),(e=>{o=e})),(0,a.YP)(l,((e,l)=>{t("update:inputText",e)})),{updateInputText:c,onSubmit:u,handleKeyDown:s,updateModel:r,resetInputValue:i,inputTextInner:l,modelInner:o,inputRefInner:n}}}),v=l(89);const f=(0,v.Z)(m,[["render",c],["__scopeId","data-v-2aa54a74"]]);var g=f},1018:function(e,t,l){l.r(t),l.d(t,{default:function(){return ze}});var a=l(3396),o=l(7139),n=l(9242),i=l(2298);const s=e=>((0,a.dD)("data-v-ff27c9f2"),e=e(),(0,a.Cn)(),e),u={class:"body",ref:"scrollRef"},r={key:0,class:"explain"},c=s((()=>(0,a._)("img",{class:"logo",alt:"Vue logo",src:i},null,-1))),d=s((()=>(0,a._)("div",{class:"expositoryCase"},"欢迎使用PERSONALITY GPT",-1))),p={class:"consume"},m=s((()=>(0,a._)("div",{class:"consumeText"},"超级实验室功能",-1))),v=s((()=>(0,a._)("div",{class:"beCareful"},"请注意不支持违法、违规等不当信息内容",-1))),f={key:1,class:"questions",style:{margin:"20px 0"}},g={class:"question"},h={class:"text"},w={class:"operation--model_user"},y=["onClick"],_=s((()=>(0,a._)("text",{class:"op-font"},"复制",-1))),x={class:"answer"},C={key:0,style:{width:"100%"}},W={key:0,class:"operation--model"},b=["onClick"],k=s((()=>(0,a._)("text",{class:"op-font"},"复制",-1))),S=["onClick"],V=s((()=>(0,a._)("text",{class:"op-font"},"收藏",-1))),I={key:1,class:"answer-data",style:{width:"100px"}},D=(0,a.uE)('<div style="display:flex;padding:5px 9px;" data-v-ff27c9f2><div class="dot_0" data-v-ff27c9f2></div><div class="dot_1" data-v-ff27c9f2></div><div class="dot_2" data-v-ff27c9f2></div><div class="dot_3" data-v-ff27c9f2></div><div class="dot_4" data-v-ff27c9f2></div></div>',1),T=[D],U=s((()=>(0,a._)("div",null,"暂停输出",-1))),H={class:"footer"},L={class:"footer-bar"},P={style:{"padding-top":"4px"}},F=s((()=>(0,a._)("div",null,"清除聊天",-1))),A={style:{"padding-top":"4px"}},E=s((()=>(0,a._)("div",null,"记忆回溯",-1))),M={style:{"padding-top":"4px"}},z=s((()=>(0,a._)("div",null,"Ai配置",-1))),q=s((()=>(0,a._)("div",{class:"cache-flex-center"},[(0,a._)("img",{alt:"Vue logo",src:i,class:"cache-img"})],-1))),K=s((()=>(0,a._)("div",{class:"cache-text"},"PERSONALITY GPT PLUS",-1))),N={class:"cache-flex-center cache-padding-top"},O=s((()=>(0,a._)("div",{class:"cache-btn-text"},"创建新的聊天",-1))),R={class:"cache-content"},G={class:"cache-scrollbar"},J={class:"cache-flex-space-between cache-margin"},Z=["onClick"],Y={class:"cache-message-text"},B={class:"cache-message-time"},j={class:"cache-selected"},$=["src","onClick"],Q={class:"config-row"},X={class:"config-title"},ee=s((()=>(0,a._)("text",null,"model_type",-1))),te={class:"config-row"},le={class:"config-title"},ae=s((()=>(0,a._)("text",null,"open_key",-1))),oe={class:"config-row"},ne={class:"config-title"},ie=s((()=>(0,a._)("text",null,"open_ai_url",-1))),se={class:"config-row"},ue={class:"config-title"},re=s((()=>(0,a._)("text",null,"top_p",-1))),ce={class:"config-row"},de={class:"config-title"},pe=s((()=>(0,a._)("text",null,"max_tokens",-1))),me={class:"config-row"},ve={class:"config-title"},fe=s((()=>(0,a._)("text",null,"temperature",-1))),ge={class:"config-row"},he={class:"config-title"},we=s((()=>(0,a._)("text",null,"speed",-1))),ye={class:"config-row"},_e={class:"config-title",style:{"align-items":"flex-start"}},xe=s((()=>(0,a._)("text",null,"questions",-1))),Ce={class:"config-row"},We={class:"config-title",style:{"align-items":"flex-start"}},be=s((()=>(0,a._)("text",null,"answer",-1))),ke={style:{"text-align":"right","margin-top":"20px"}};function Se(e,t,i,s,D,Se){const Ve=(0,a.up)("Goods"),Ie=(0,a.up)("el-icon"),De=(0,a.up)("CopyDocument"),Te=(0,a.up)("el-avatar"),Ue=(0,a.up)("v-md-editor"),He=(0,a.up)("StarFilled"),Le=(0,a.up)("VideoPause"),Pe=(0,a.up)("Clock"),Fe=(0,a.up)("ChatDotRound"),Ae=(0,a.up)("Tools"),Ee=(0,a.up)("InputFormField"),Me=(0,a.up)("ChatLineSquare"),ze=(0,a.up)("el-scrollbar"),qe=(0,a.up)("el-dialog"),Ke=(0,a.up)("info-filled"),Ne=(0,a.up)("el-popover"),Oe=(0,a.up)("el-input"),Re=(0,a.up)("el-button"),Ge=(0,a.up)("el-drawer"),Je=(0,a.up)("LoginDialog");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",u,[s.conversationList.length<=1?((0,a.wg)(),(0,a.iD)("div",r,[c,d,(0,a._)("div",p,[(0,a.Wm)(Ie,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Ve)])),_:1}),m]),v])):((0,a.wg)(),(0,a.iD)("div",f,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.conversationList,((e,t)=>(0,a.wy)(((0,a.wg)(),(0,a.iD)("div",{key:t,class:"item slide-animation"},[(0,a._)("div",g,[(0,a._)("div",null,[(0,a._)("div",h,(0,o.zw)(e.user),1),(0,a._)("div",w,[(0,a._)("div",{class:"op-btn",onClick:t=>s.copyAnswer(e.user)},[(0,a.Wm)(Ie,null,{default:(0,a.w5)((()=>[(0,a.Wm)(De)])),_:1}),_],8,y)])]),(0,a.Wm)(Te,{class:"flexShrink",size:35,icon:Se.UserFilled,src:Se.store.getters.userinfo.avatar?s.imageUrl+Se.store.getters.userinfo.avatar:l(2231)},null,8,["icon","src"])]),(0,a._)("div",x,[(0,a.Wm)(Te,{class:"flexShrink",size:35,icon:Se.UserFilled,src:l(2298)},null,8,["icon","src"]),e.assistant?((0,a.wg)(),(0,a.iD)("div",C,[(0,a._)("div",{class:"answer-data",style:(0,o.j5)({maxWidth:s.calculateWidth(e.assistant)})},[(0,a.Wm)(Ue,{"model-value":e.assistant,mode:"preview",onCopyCodeSuccess:s.handleCopyCodeSuccess},null,8,["model-value","onCopyCodeSuccess"])],4),e.isError?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",W,[(0,a._)("div",{class:"op-btn",onClick:t=>s.copyAnswer(e.assistant)},[(0,a.Wm)(Ie,null,{default:(0,a.w5)((()=>[(0,a.Wm)(De)])),_:1}),k],8,b),e.isCollection?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",{key:0,class:"op-btn",onClick:l=>s.onCollection(e,t)},[(0,a.Wm)(Ie,{color:"rgb(255,236,160)"},{default:(0,a.w5)((()=>[(0,a.Wm)(He)])),_:1}),V],8,S))]))])):((0,a.wg)(),(0,a.iD)("div",I,T))])])),[[n.F8,0!==t]]))),128))])),(0,a.wy)((0,a._)("div",{class:"suspend",onClick:t[0]||(t[0]=(...e)=>s.closeSocket&&s.closeSocket(...e))},[(0,a.Wm)(Ie,{size:16},{default:(0,a.w5)((()=>[(0,a.Wm)(Le)])),_:1}),U],512),[[n.F8,s.aiLoading]]),(0,a._)("div",H,[(0,a._)("div",L,[(0,a.wy)((0,a._)("div",{class:"clear",onClick:t[1]||(t[1]=(...e)=>s.clear&&s.clear(...e))},[(0,a._)("div",P,[(0,a.Wm)(Ie,{size:"13px",style:{"padding-right":"3px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(Pe)])),_:1})]),F],512),[[n.F8,Se.store.getters.userinfo&&!s.aiLoading]]),(0,a.wy)((0,a._)("div",{class:"clear2",onClick:t[2]||(t[2]=e=>s.dialogueDisplay=!0)},[(0,a._)("div",A,[(0,a.Wm)(Ie,{size:"13px",style:{"padding-right":"3px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(Fe)])),_:1})]),E],512),[[n.F8,Se.store.getters.userinfo&&!s.aiLoading]]),(0,a.wy)((0,a._)("div",{class:"clear3",onClick:t[3]||(t[3]=e=>s.configDisplay=!0)},[(0,a._)("div",M,[(0,a.Wm)(Ie,{size:"13px",style:{"padding-right":"3px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(Ae)])),_:1})]),z],512),[[n.F8,Se.store.getters.userinfo&&!s.aiLoading]]),(0,a.Wm)(Ee,{ref:"inputRef",needSelect:!1,aiLoading:s.aiLoading,inputText:s.input,"onUpdate:inputText":t[4]||(t[4]=e=>s.input=e),"onUpdate:model":t[5]||(t[5]=e=>s.model=e),onOnSubmit:s.onSubmit},null,8,["aiLoading","inputText","onOnSubmit"])])])],512),(0,a.Wm)(qe,{modelValue:s.dialogueDisplay,"onUpdate:modelValue":t[7]||(t[7]=e=>s.dialogueDisplay=e),width:"430px",center:"",style:{"background-color":"var(--bgColor1)"}},{default:(0,a.w5)((()=>[(0,a._)("div",null,[q,K,(0,a._)("div",N,[(0,a._)("div",{class:"cache-btn",onClick:t[6]||(t[6]=(...e)=>s.createdNewChat&&s.createdNewChat(...e))},[(0,a.Wm)(Ie,{size:"16px"},{default:(0,a.w5)((()=>[(0,a.Wm)(Me)])),_:1}),O])]),(0,a._)("div",R,[(0,a._)("div",G,[(0,a.Wm)(ze,{height:"250px"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(s.personalityCache.array,((e,t)=>((0,a.wg)(),(0,a.iD)("div",{class:"cache-padding",key:t},[(0,a._)("div",J,[(0,a._)("div",{class:"cache-message",onClick:e=>s.switchChat(t)},[(0,a._)("div",Y,(0,o.zw)(e.title),1),(0,a._)("div",B,(0,o.zw)(Se.conversionTime(e.time)),1)],8,Z),(0,a._)("div",j,[(0,a._)("img",{src:s.personalityCache.index===t?l(4873):l(5860),class:"cache-selected-img",onClick:e=>s.clearDialogue(t),alt:""},null,8,$)])])])))),128))])),_:1})])])])])),_:1},8,["modelValue"]),(0,a.Wm)(Ge,{modelValue:s.configDisplay,"onUpdate:modelValue":t[17]||(t[17]=e=>s.configDisplay=e),direction:"ltr",size:"400px",title:"模型配置",style:{"background-color":"var(--bgColor1)"}},{default:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a._)("div",Q,[(0,a._)("div",X,[ee,(0,a.Wm)(Ne,{placement:"bottom",effect:"dark",title:"模型名称",width:300,trigger:"hover",content:"gpt-3.5-turbo gpt-3.5-turbo-16k-0613 gpt-4-0314 ...可根据提供的密钥来选择"},{reference:(0,a.w5)((()=>[(0,a.Wm)(Ie,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Ke)])),_:1})])),_:1})]),(0,a._)("div",null,[(0,a.Wm)(Oe,{style:{width:"230px"},placeholder:"请设置模型名称",maxlength:"20",modelValue:s.form.model,"onUpdate:modelValue":t[8]||(t[8]=e=>s.form.model=e)},null,8,["modelValue"])])]),(0,a._)("div",te,[(0,a._)("div",le,[ae,(0,a.Wm)(Ne,{placement:"bottom",effect:"dark",title:"密钥",width:300,trigger:"hover",content:"填写用于建立对话连接的GPT TOKEN身份令牌 如: sk-P3xGzxJ5POkJ55SibZb..."},{reference:(0,a.w5)((()=>[(0,a.Wm)(Ie,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Ke)])),_:1})])),_:1})]),(0,a._)("div",null,[(0,a.Wm)(Oe,{style:{width:"230px"},modelValue:s.form.openKey,"onUpdate:modelValue":t[9]||(t[9]=e=>s.form.openKey=e),maxlength:"200",placeholder:"请设置请求密钥"},null,8,["modelValue"])])]),(0,a._)("div",oe,[(0,a._)("div",ne,[ie,(0,a.Wm)(Ne,{placement:"bottom",effect:"dark",title:"GPT请求地址",width:300,trigger:"hover",content:"格式为 https://chatgpt1.nextweb.fun/api/proxy/v1"},{reference:(0,a.w5)((()=>[(0,a.Wm)(Ie,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Ke)])),_:1})])),_:1})]),(0,a._)("div",null,[(0,a.Wm)(Oe,{style:{width:"230px"},modelValue:s.form.openAiUrl,"onUpdate:modelValue":t[10]||(t[10]=e=>s.form.openAiUrl=e),placeholder:"请设置请求链接",maxlength:"100"},null,8,["modelValue"])])]),(0,a._)("div",se,[(0,a._)("div",ue,[re,(0,a.Wm)(Ne,{placement:"bottom",effect:"dark",title:"对话多样性",width:300,trigger:"hover",content:"值越大对话越多样 范围(0 - 2)之间 推荐值: 1"},{reference:(0,a.w5)((()=>[(0,a.Wm)(Ie,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Ke)])),_:1})])),_:1})]),(0,a._)("div",null,[(0,a.Wm)(Oe,{style:{width:"230px"},modelValue:s.form.top_p,"onUpdate:modelValue":t[11]||(t[11]=e=>s.form.top_p=e),maxlength:"1",placeholder:"请设置对话多样性"},null,8,["modelValue"])])]),(0,a._)("div",ce,[(0,a._)("div",de,[pe,(0,a.Wm)(Ne,{placement:"bottom",effect:"dark",title:"最大文本输出限制",width:300,trigger:"hover",content:"用于控制GPT最大回复字符长度(依据TOKENS计算) 推荐值: 2048"},{reference:(0,a.w5)((()=>[(0,a.Wm)(Ie,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Ke)])),_:1})])),_:1})]),(0,a._)("div",null,[(0,a.Wm)(Oe,{style:{width:"230px"},modelValue:s.form.max_tokens,"onUpdate:modelValue":t[12]||(t[12]=e=>s.form.max_tokens=e),placeholder:"请设置最大文本输出限制",maxlength:"4"},null,8,["modelValue"])])]),(0,a._)("div",me,[(0,a._)("div",ve,[fe,(0,a.Wm)(Ne,{placement:"bottom",effect:"dark",title:"温度控制",width:300,trigger:"hover",content:"值越大回复内容越随机 范围(0 - 2)之间 推荐值: 1"},{reference:(0,a.w5)((()=>[(0,a.Wm)(Ie,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Ke)])),_:1})])),_:1})]),(0,a._)("div",null,[(0,a.Wm)(Oe,{style:{width:"230px"},modelValue:s.form.temperature,"onUpdate:modelValue":t[13]||(t[13]=e=>s.form.temperature=e),placeholder:"请设置温度控制",maxlength:"1"},null,8,["modelValue"])])]),(0,a._)("div",ge,[(0,a._)("div",he,[we,(0,a.Wm)(Ne,{placement:"bottom",effect:"dark",title:"回复速率",width:300,trigger:"hover",content:"用于控制GPT文字输出速度 范围(0 - 99) 越小打字流效果输出越快 推荐值 20"},{reference:(0,a.w5)((()=>[(0,a.Wm)(Ie,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Ke)])),_:1})])),_:1})]),(0,a._)("div",null,[(0,a.Wm)(Oe,{style:{width:"230px"},modelValue:s.form.speed,"onUpdate:modelValue":t[14]||(t[14]=e=>s.form.speed=e),placeholder:"请设置回复速率",maxlength:"2"},null,8,["modelValue"])])]),(0,a._)("div",ye,[(0,a._)("div",_e,[xe,(0,a.Wm)(Ne,{placement:"bottom",effect:"dark",title:"提问预设词",width:300,trigger:"hover",content:"例如: 我想让你充当一个讲故事的人。你将想出有趣的故事，这些故事要引人入胜、富有想象力和吸引人。如果明白请回复: 请提供故事主题"},{reference:(0,a.w5)((()=>[(0,a.Wm)(Ie,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Ke)])),_:1})])),_:1})]),(0,a._)("div",null,[(0,a.Wm)(Oe,{style:{width:"230px"},type:"textarea",row:4,modelValue:s.form.questions,"onUpdate:modelValue":t[15]||(t[15]=e=>s.form.questions=e),placeholder:"请设置提问预设词",maxlength:"1000"},null,8,["modelValue"])])]),(0,a._)("div",Ce,[(0,a._)("div",We,[be,(0,a.Wm)(Ne,{placement:"bottom",effect:"dark",title:"回答预设词",width:300,trigger:"hover",content:"例如对应上面的操作: 请提供故事主题 , questions 和 answer相当于设置 第一次对话 用于主动引导GPT对话走向"},{reference:(0,a.w5)((()=>[(0,a.Wm)(Ie,null,{default:(0,a.w5)((()=>[(0,a.Wm)(Ke)])),_:1})])),_:1})]),(0,a._)("div",null,[(0,a.Wm)(Oe,{style:{width:"230px"},type:"textarea",row:4,modelValue:s.form.answer,"onUpdate:modelValue":t[16]||(t[16]=e=>s.form.answer=e),placeholder:"请设置回答预设词",maxlength:"1000"},null,8,["modelValue"])])]),(0,a._)("div",ke,[(0,a.Wm)(Re,{color:"var(--themeColor2)",style:{width:"100px"},onClick:s.submitPersonalityConfig,loading:s.loading},{default:(0,a.w5)((()=>[(0,a.Uk)("应用 ")])),_:1},8,["onClick","loading"]),(0,a.Wm)(Re,{color:"var(--bgColor3)",style:{width:"100px",background:"var(--bgColor3)",color:"var(--textColor2)"},onClick:s.resetPersonalityConfig},{default:(0,a.w5)((()=>[(0,a.Uk)("重置 ")])),_:1},8,["onClick"])])])])),_:1},8,["modelValue"]),(0,a.Wm)(Je,{show:s.loginVisible,onClose:t[18]||(t[18]=e=>s.loginVisible=!1)},null,8,["show"])],64)}l(7658),l(541);var Ve=l(4870),Ie=l(2748),De=l(6666),Te=l(7278),Ue=l(65),He=l(718),Le=l(789),Pe=l(4239),Fe=l(7220),Ae={name:"dialogueView",methods:{conversionTime:Fe.Z},components:{InfoFilled:Ie.InfoFilled,Tools:Ie.Tools,StarFilled:Ie.StarFilled,CopyDocument:Ie.CopyDocument,InputFormField:Le.Z,ChatDotRound:Ie.ChatDotRound,ChatLineSquare:Ie.ChatLineSquare,Clock:Ie.Clock,VideoPause:Ie.VideoPause,Goods:Ie.Goods,LoginDialog:He.Z},computed:{store(){return Pe.Z},UserFilled(){return Ie.UserFilled}},setup(){let e=(0,Ve.iH)(50),t=(0,Ve.iH)(740),l=(0,Ve.iH)(null),o=(0,Ue.oR)(),n=(0,Ve.iH)(null),i=(0,Ve.iH)(""),s=(0,Ve.iH)([]),u=(0,Ve.iH)(!1),r=(0,Ve.iH)(null),c=(0,Ve.iH)(!1);const d=(0,Ve.iH)(!1);let p=(0,Ve.iH)("BASIC");const m=(0,Ve.iH)("");let v=(0,Ve.iH)(!1);const f=(0,Ve.iH)({}),g=(0,Ve.iH)("30%"),h=(0,Ve.iH)(!1),w=(0,Ve.iH)({model:"gpt-3.5-turbo",top_p:1,max_tokens:2048,temperature:1,openKey:"",openAiUrl:"https://chatgpt1.nextweb.fun/api/proxy/v1",questions:"我想让你充当一个讲故事的人。你将想出有趣的故事，这些故事要引人入胜、富有想象力和吸引人。如果明白请回复: 请提供故事主题",answer:"请提供故事主题",speed:50}),y=(0,Ve.iH)(10),_=(0,Ve.iH)(1e3);async function x(){let e=await(0,Te.JV)();e?(w.value=e,s.value.length>0?s.value[0]={user:w.value.questions,assistant:w.value.answer,isError:!1}:s.value.push({user:w.value.questions,assistant:w.value.answer,isError:!1})):s.value[0]={user:"你好",assistant:"您好!我是 TIME SEA 助手 , 请问有什么需要帮助的吗?",isError:!1}}async function C(){if(!h.value){let t=w.value;for(let e in t)if(!t[e])return void(0,De.bM)({title:"错误",message:e+"不能为空",type:"error"});h.value=!0;try{await(0,Te.nz)(w.value),await x(),h.value=!1,(0,De.bM)({message:"应用成功",type:"success"})}catch(e){h.value=!1,(0,De.bM)({title:"错误",message:e,type:"error"})}}}async function W(){h.value||(w.value={model:"gpt-3.5-turbo",top_p:1,max_tokens:2048,temperature:1,openKey:"",openAiUrl:"https://chatgpt1.nextweb.fun/api/proxy/v1",questions:"我想让你充当一个讲故事的人。你将想出有趣的故事，这些故事要引人入胜、富有想象力和吸引人。如果明白请回复: 请提供故事主题",answer:"请提供故事主题",speed:50},(0,De.bM)({message:"已重置",type:"success"}))}function b(e){e.ctrlKey&&13===e.keyCode&&(console.log("Alt + Enter 被按下"),U())}function k(){window.innerWidth<=768?g.value="70%":g.value="30%"}function S(e){f.value.index=e,s.value=f.value.array[e].context,localStorage.setItem("personalityCache",JSON.stringify(f.value)),v.value=!1}function V(l){const a=l.length;let o=e.value+16*a;return o>=t.value&&(o=t.value),`${o}px`}function I(e){if(e!==f.value.index){let t=parseInt(f.value.index);e<t&&(f.value.index=t-1),f.value.array.splice(e,1)}localStorage.setItem("personalityCache",JSON.stringify(f.value))}function D(){let e=s.value,t=f.value;f.value.array[t.index].time=Date.now(),e.length>0&&(f.value.array[t.index].title=e[e.length-1].user.trim().slice(0,25)),f.value.array[t.index].context=e,localStorage.setItem("personalityCache",JSON.stringify(f.value))}async function T(){f.value.array.unshift({title:"新对话",time:Date.now(),context:[]}),await x(),f.value.index=0,s.value=[],localStorage.setItem("personalityCache",JSON.stringify(f.value))}async function U(){if(!o.getters.userinfo)return void(u.value=!0);if(console.log("父的提交，onSubmit()->input",i),console.log("父的提交，onSubmit()->input.value",i.value),""===i.value.trim())return;let e=s.value.length,t=i.value;l.value.resetInputValue(),s.value.push({user:t}),c.value=!0,M();let a=[];s.value.slice(-y.value).forEach((({isError:e,user:t,assistant:l},o,n)=>{if(!e){let e=t,i=l;n.length>2&&o!==n.length-1&&o!==n.length-2&&(e=t.length>_.value?t.slice(0,_.value)+"...":t,i=l&&l.length>_.value?l.slice(0,_.value)+"...":l),a.push({role:"user",content:e}),i&&a.push({role:"assistant",content:i})}})),H({messages:{messages:a},index:e})}function H({messages:e,index:t}){"undefined"==typeof WebSocket?console.log("您的浏览器不支持WebSocket"):(null!=r.value&&(r.value.close(),r.value=null),console.log("发起websocket",p.value),r.value=new WebSocket("ws://47.109.74.83:8625/personality/api/"+localStorage.getItem("token")),r.value.onopen=function(){r.value.send(JSON.stringify(e)),s.value[t].isError=!0},r.value.onmessage=function(e){L.push({msg:e.data,index:t}),F()},r.value.onclose=function(){A(t)},r.value.onerror=function(){(0,De.bM)({title:"信息过期",message:"登录信息已过期,请重新登录",type:"error"}),localStorage.removeItem("token"),localStorage.removeItem("user"),location.reload()})}(0,a.bv)((()=>{window.addEventListener("resize",k),k(),o.getters.userinfo&&E(),m.value="https://img-hh.oss-cn-hangzhou.aliyuncs.com",y.value=parseInt("4"),_.value=parseInt("2000");let e=localStorage.getItem("personalityCache");if(o.getters.userinfo){if(!o.getters.userinfo)return u.value=!0;if(e){f.value=JSON.parse(e);let t=f.value;s.value=t.array[t.index].context,M()}else f.value={index:0,array:[{title:"新对话",time:Date.now(),context:s.value}]},localStorage.setItem("personalityCache",JSON.stringify(f.value));x()}}));const L=[];let P=!1;function F(){if(P)return;P=!0;const e=L.shift();if(e){let t=0;function l(){const a=e.index,o=e.msg,n=o.charAt(t++);n?(s.value[a].assistant?s.value[a].assistant+=n:s.value[a].assistant=n,M(),setTimeout(l,w.value.speed)):(P=!1,F())}l()}else P=!1}function A(e){return new Promise((t=>{let o=setInterval((()=>{if(0===L.length){let n=s.value[e].assistant;s.value[e].isError=!1,n||s.value.splice(e,1),D(),E(),c.value=!1,M(),(0,a.Y3)((()=>{l.value.$refs.inputRefInner.focus()})),clearInterval(o),t()}}),50)}))}async function E(){let e=await(0,Te.CC)();o.commit("setUserinfo",e)}function M(){(0,a.Y3)((()=>{n.value.scrollTop=n.value.scrollHeight}))}function z(e){navigator.clipboard.writeText(e),(0,De.bM)({message:"复制成功",type:"success"})}function q(e){navigator.clipboard.writeText(e),(0,De.bM)({message:"复制成功",type:"success"})}function K(){r.value&&(L.length=0,r.value.close(),r.value=null)}async function N(){K(),s.value=[],await x(),D()}async function O(e,t){try{let a=!s.value[t].isCollection;if(a)try{await(0,Te.wm)({issue:e.user,answer:e.assistant}),(0,De.bM)({message:"收藏成功",type:"success"})}catch(l){(0,De.bM)({message:l,type:"error"})}s.value[t].isCollection=!0}catch(l){(0,De.bM)({message:l,type:"error"})}}return{resetPersonalityConfig:W,loading:h,handleKeyDown:b,inputRef:l,model:p,onSubmit:U,input:i,clear:N,conversationList:s,scrollRef:n,handleCopyCodeSuccess:z,loginVisible:u,onCollection:O,copyAnswer:q,aiLoading:c,closeSocket:K,imageUrl:m,dialogueDisplay:v,configDisplay:d,personalityCache:f,createdNewChat:T,switchChat:S,clearDialogue:I,dialogueWidth:g,calculateWidth:V,initialWidth:e,maxWidth:t,form:w,submitPersonalityConfig:C}}},Ee=l(89);const Me=(0,Ee.Z)(Ae,[["render",Se],["__scopeId","data-v-ff27c9f2"]]);var ze=Me},5860:function(e,t,l){e.exports=l.p+"assets/img/close.5a0f034d.svg"},2298:function(e,t,l){e.exports=l.p+"assets/img/personality.5e7fc800.svg"},4873:function(e,t,l){e.exports=l.p+"assets/img/selected05.4cf4dcc1.svg"},2231:function(e,t,l){e.exports=l.p+"assets/img/my.5065d1f5.png"}}]);