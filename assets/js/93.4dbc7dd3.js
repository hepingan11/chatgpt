"use strict";(self["webpackChunkchatgpt"]=self["webpackChunkchatgpt"]||[]).push([[93],{185:function(e,t,o){o.d(t,{Z:function(){return y}});var l=o(3396),n=o(7139);const a=e=>((0,l.dD)("data-v-598979df"),e=e(),(0,l.Cn)(),e),r={class:"ViewState ViewStateCenter"},u={key:0,class:"ViewStateLoad"},i=a((()=>(0,l._)("div",{class:"loadAnimation"},null,-1))),s={class:"loadText"},c={key:1,class:"errCen"};function d(e,t,o,a,d,v){const p=(0,l.up)("el-empty");return(0,l.wg)(),(0,l.iD)("div",r,["load"===e.Type?((0,l.wg)(),(0,l.iD)("div",u,[i,(0,l._)("div",s,(0,n.zw)(e.LoadText),1)])):"empty"===e.Type||"error"===e.Type?((0,l.wg)(),(0,l.iD)("div",c,[(0,l.Wm)(p,{class:"ViewStateCover",description:"empty"===e.Type?e.EmptyText:e.ErrorText},null,8,["description"]),e.IsShowBottom?((0,l.wg)(),(0,l.iD)("div",{key:0,onClick:t[0]||(t[0]=(...t)=>e.clickTheButton&&e.clickTheButton(...t)),"hover-class":"empty-but-hover","hover-start-time":"0","hover-stay-time":"0",class:"ViewStateBottom"},(0,n.zw)(e.ButtonText),1)):(0,l.kq)("",!0)])):(0,l.kq)("",!0)])}var v=(0,l.aZ)({name:"ViewState",props:{Type:{type:String,default:"load"},LoadText:{type:String,default:"加载中..."},EmptyText:{type:String,default:"数据为空"},ErrorText:{type:String,default:"加载错误"},ButtonText:{type:String,default:"重新加载"},ErrorCover:{type:String,default:"@/assets/error.svg"},EmptyCover:{type:String,default:"@/assets/empty.svg"},IsShowBottom:{type:Boolean,default:!1}},setup(e,{emit:t}){function o(){t("ClickTheButton")}return{clickTheButton:o}}}),p=o(89);const m=(0,p.Z)(v,[["render",d],["__scopeId","data-v-598979df"]]);var y=m},3093:function(e,t,o){o.r(t),o.d(t,{default:function(){return S}});var l=o(3396),n=o(7139);const a={key:2,class:"body",ref:"scrollRef"},r={class:"container"},u={class:"title"},i={class:"result"},s={class:"completeText"};function c(e,t,o,c,d,v){const p=(0,l.up)("ViewState"),m=(0,l.up)("v-md-editor");return c.load?((0,l.wg)(),(0,l.j4)(p,{key:0,LoadText:"正在生成，请稍后..."})):c.error?((0,l.wg)(),(0,l.j4)(p,{key:1,onClickTheButton:c.back,Type:"error",ErrorText:"AI服务调用失败，正在紧急处理，请稍后使用。",IsShowBottom:"",ButtonText:"返回"},null,8,["onClickTheButton"])):((0,l.wg)(),(0,l.iD)("div",a,[(0,l._)("div",r,[(0,l._)("div",u,(0,n.zw)(c.item),1),(0,l._)("div",i,[(0,l._)("div",s,[(0,l.Wm)(m,{"model-value":c.content,mode:"preview"},null,8,["model-value"])])]),(0,l._)("button",{onClick:t[0]||(t[0]=(...e)=>c.back&&c.back(...e)),class:"determineTheBuild",type:"primary"}," 返回上一页 ")])],512))}o(7658);var d=o(2483),v=o(4870),p=o(185),m=o(1120),y=o(7278),f=o(4239),g=o(6666),k={name:"CreateDetailView",methods:{router(){return m.Z}},components:{ViewState:p.Z},setup(){let e=(0,d.tv)(),t=e.currentRoute.value.query,o=(0,v.iH)(!!t.role&&JSON.parse(decodeURIComponent(t.role))),n=(0,v.iH)(JSON.parse(decodeURIComponent(t.item))),a=(0,v.iH)(!1),r=(0,v.iH)(!1),u=(0,v.iH)(""),i=(0,v.iH)(null),s=(0,v.iH)(null),c=(0,v.iH)([]);function p(){setTimeout((()=>s.value.scrollTop=s.value.scrollHeight),20)}function m(){"undefined"==typeof WebSocket?console.log("您的浏览器不支持WebSocket"):(a.value=!0,null!=i.value&&(i.value.close(),i.value=null),i.value=new WebSocket("ws://47.109.74.83:8625/gpt-web/api/"+localStorage.getItem("token")+"/gpt-3.5-turbo"),i.value.onopen=function(){i.value.send(JSON.stringify({messages:c.value}))},i.value.onmessage=function(e){a.value=!1,u.value?u.value+=e.data:u.value=e.data,p()},i.value.onclose=function(){console.log("websocket已关闭"),k()},i.value.onerror=function(){(0,g.bM)({title:"信息过期",message:"登录信息已过期,请重新登录",type:"error"}),localStorage.removeItem("token"),localStorage.removeItem("user"),location.reload()})}async function k(){try{let e=await(0,y.CC)();f.Z.commit("setUserinfo",e)}catch(e){console.log(e)}}function w(){i.value.close(),i.value=null}function T(){w(),e.go(-1)}return o.value&&c.value.push({role:"system",content:o.value}),c.value.push({role:"user",content:n.value}),(0,l.bv)((()=>{m()})),{load:a,error:r,content:u,item:n,back:T,scrollRef:s}}},w=o(89);const T=(0,w.Z)(k,[["render",c],["__scopeId","data-v-81ca6122"]]);var S=T}}]);